<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css"
          integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
    <link rel="stylesheet" href="../CSS/style.css">
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAUU0g9V29f8krqM7DmDO-wZzFonNe_eX8"
            async defer></script>
    <script src="https://d3js.org/d3.v3.min.js"></script>
    <title>How the location impact house price?</title>
    <style type="text/css">

        select {
            position: absolute;
            left:7px;
            top:510px;
        }

        .hgdp, .hgdp svg {
            position: absolute;
        }

        .tooltip {
            position: absolute;
            line-height: .7;
            font-weight: bold;
            padding: 8px;
            background: rgba(0, 0, 0, 0.8);
            color: #fff;
            font-weight: bold;
            font: 11.5px sans-serif;
            border-radius: 2px;
            pointer-events: none;
        }

        .hgdp svg {
            width: 60px;
            height: 20px;
            padding-right: 100px;
            font: 7px sans-serif;
        }

        .hgdp circle {
            stroke: white;
            stroke-width: 1.5px;
        }

    </style>
</head>
<body>
<div class="container">
    <!-- Title & Subtitle -->
    <div class="row shadow p-3 mb-5 bg-white rounded margin-top">
        <div class="col">
            <h1 class="text-center"><b>How the location impact the house price?</b></h1>
            <h4 class="text-center grey">Melbourne metropolitan map combining with scatter</h4>
        </div>
    </div>
    <!-- Main Content -->
    <div class="row shadow p-3 mb-5 bg-white rounded justify-content-center">
        <div class="col-4">
            <div>
                <h4><b>Property Type</b></h4>
            </div>
            <div class="btn-group" role="group" aria-label="First Group">
                <button type="button" class="btn btn-secondary text-left">Unit</button>
                <button type="button" class="btn btn-secondary text-left">House</button>
                <button type="button" class="btn btn-secondary text-left">Townhouse</button>
            </div>
            <div class="margin-top">
                <h4><b>Number of Bedrooms</b></h4>
            </div>
            <div class="btn-group" role="group" aria-label="Second Group">
                <button type="button" class="btn btn-secondary text-left">1</button>
                <button type="button" class="btn btn-secondary text-left">2</button>
                <button type="button" class="btn btn-secondary text-left">3</button>
                <button type="button" class="btn btn-secondary text-left">4</button>
                <button type="button" class="btn btn-secondary text-left">5+</button>
            </div>
            <div class="margin-top">
                <h4><b>Interactive Text</b></h4>
            </div>
            <div>
                <p class="text-justify font-italic font-weight-light">
                    This area will display some text and this is the main part that we are going to tell stories and
                    display
                    valuable information in order achieve the goal of narrative visualisation. When a mouse is hovering
                    over
                    a node on the map, the text area will display its relative information based on the calculation.
                </p>
            </div>
        </div>
        <div class="col">
            <div>
                <h4 class="text-center"><b>Interactive Map</b></h4>
            </div>
            <div id="map">
            </div>
        </div>
    </div>
    <!-- Trend -->
    <div class="row shadow p-3 mb-5 bg-white rounded">
        <div class="col">
            <div>
                <h4 class="text-left"><b>House Price Trend</b></h4>
            </div>
            <div>
                <img class="img-fluid" src="../DATA/TREND.png" alt="Melbourne Metropolitan Map">
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">

    var map = new google.maps.Map(d3.select("#map").node(), {
        zoom: 2,
        draggableCursor: 'crosshair',
        center: new google.maps.LatLng(17, 4),
        mapTypeId: google.maps.MapTypeId.TERRAIN,
        backgroundColor: "white",
        mapMaker: 'True',
        styles: [
            {
                featureType: "all",
                elementType: "labels",
                stylers: [{ visibility: "off" }]
            }
        ]
    });

    // Load the hgdp data. When the data comes back, create an overlay.
    d3.csv("../DATA/test.csv", function(data) {
        var overlay = new google.maps.OverlayView();

        // Add the container when the overlay is added to the map.
        overlay.onAdd = function() {
            var layer = d3.select(this.getPanes().overlayMouseTarget).append("div")
                .attr("class", "hgdp");

            // Draw each marker as a separate SVG element.
            overlay.draw = function() {
                var projection = this.getProjection(),
                    padding = 10;

                var color = d3.scale.linear()
                    .domain([0, 1])
                    .range(["blue", "red"]);

                var tooltip = d3.select("body")
                    .append("div")
                    .attr("class", "tooltip")
                    .style("opacity", 0);

                var marker = layer.selectAll("svg")
                    .data(d3.entries(data))
                    .each(transform) // update existing markers
                    .enter().append("svg:svg")
                    .each(transform)
                    .attr("class", "marker");

                // Add a circle.
                marker.append("svg:circle")
                    .attr("r", 5)
                    .attr("cx", padding)
                    .attr("cy", padding)
                    .on("mouseover", function(d) {

                        console.log("asdfsafd");

                        tooltip.transition()
                            .duration(200)
                            .style("opacity", .9);
                        tooltip.html('Population: ' + d.value.Address + '<br>')
                            .style("left", (d3.event.pageX + 5) + "px")
                            .style("top", (d3.event.pageY - 28) + "px");
                    })
                    .on("mouseout", function(d) {
                        tooltip.transition()
                            .duration(200)
                            .style("opacity", 0);
                    });

                function transform(d) {
                    pos = new google.maps.LatLng(d.value.Lattitude, d.value.Longtitude);
                    pos = projection.fromLatLngToDivPixel(pos);
                    return d3.select(this)
                        .style("left", (pos.x - padding) + "px")
                        .style("top", (pos.y - padding) + "px")
                        .attr('fill', color(d.value[2]))
                }
            };
        };

        // Bind our overlay to the mapâ€¦
        overlay.setMap(map);
    });

</script>

<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"
        integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T"
        crossorigin="anonymous"></script>
<!-- D3 -->
<!--<script src="https://d3js.org/d3.v3.min.js"></script>-->
<!-- Google Map -->
<!--<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAUU0g9V29f8krqM7DmDO-wZzFonNe_eX8&callback=initMap"-->
        <!--async defer></script>-->
<!-- Customized JS -->
<script src="../JS/script.js"></script>
</body>
</html>